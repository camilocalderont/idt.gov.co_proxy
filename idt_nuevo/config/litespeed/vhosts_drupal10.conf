# Virtual Host Configuration for Drupal 10 - IDT.gov.co
# Configuración optimizada para producción con miles de visitas

docRoot                   /var/www/html
vhDomain                  www.idt.gov.co
vhAliases                 idt.gov.co
adminEmails               admin@idt.gov.co
enableGzip                1
enableIpGeo               1

errorlog $VH_ROOT/logs/error.log {
  useServer               0
  logLevel                WARN
  rollingSize             10M
  keepDays                7
}

accesslog $VH_ROOT/logs/access.log {
  useServer               0
  rollingSize             10M
  keepDays                30
  compressArchive         1
}

index  {
  useServer               0
  indexFiles              index.php, index.html
  autoIndex               0
  autoIndexURI            /_autoindex/default.php
}

scripthandler  {
  add                     lsphp83 php
}

phpIniOverride  {
  php_admin_value upload_tmp_dir "/tmp"
  php_admin_value session.save_path "/tmp/sessions"
  php_admin_value open_basedir "/var/www/html:/tmp:/usr/local/lsws"
}

# Configuración específica para Drupal - Delegar mod_rewrite a .htaccess
rewrite  {
  enable                  1
  autoLoadHtaccess        1
  logLevel                0
}

## 5. Virtual Host Drupal 10 Minimalista (config/litespeed/vhosts_drupal10.conf)

```apache
# Virtual Host Configuration for Drupal 10 - Básico
# IDT.gov.co - Configuración minimalista

docRoot                   /var/www/html
vhDomain                  www.idt.gov.co
vhAliases                 idt.gov.co

errorlog $VH_ROOT/logs/error.log {
  logLevel                INFO
  rollingSize             10M
}

accesslog $VH_ROOT/logs/access.log {
  rollingSize             10M
  keepDays                7
}

# Archivos índice
index  {
  indexFiles              index.php, index.html
  autoIndex               0
}

# Asociar PHP
scripthandler  {
  add                     lsphp83 php
}

# IMPORTANTE: Delegar mod_rewrite a .htaccess de Drupal
rewrite  {
  enable                  1
  autoLoadHtaccess        1
}

# Context principal para PHP
context / {
  type                    php
  location                /var/www/html/
  allowBrowse             1
  indexFiles              index.php
}

# Security: Denegar acceso a archivos sensibles
context ~ "\.(engine|inc|info|install|make|module|profile|test|po|sh|.*sql|theme|tpl(\.php)?|xtmpl)(~|\.sw[op]|\.bak|\.orig|\.save)?$|^(\..*|Entries.*|Repository|Root|Tag|Template|composer\.(json|lock))$|^#.*#$|\.php(~|\.sw[op]|\.bak|\.orig\.save)$" {
  type                    null
  allowBrowse             0
  accessControl  {
    deny                  *
  }
}

# Security: Denegar acceso a directorios privados
context /sites/*/private/ {
  type                    null
  allowBrowse             0
  accessControl  {
    deny                  *
  }
}

# Cache básico para archivos estáticos
context /sites/default/files/ {
  type                    null
  location                /var/www/html/sites/default/files/
  allowBrowse             1

  expires {
    enableExpires         1
    expiresByType         image/*=A604800, text/css=A604800, application/javascript=A604800
  }
}

# Habilitar compresión
enableGzip              1
gzipCompressLevel       6