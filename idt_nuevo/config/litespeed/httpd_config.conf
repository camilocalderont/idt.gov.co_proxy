# LiteSpeed HTTP Configuration - Básica para Drupal 10
# IDT.gov.co - Configuración minimalista

serverName                $hostname
user                      nobody
group                     nogroup
autoRestart               1

errorlog $SERVER_ROOT/logs/error.log {
  logLevel                INFO
  rollingSize             10M
}

accesslog $SERVER_ROOT/logs/access.log {
  rollingSize             10M
  keepDays                7
}

# Configuraciones básicas para buen rendimiento
tuning  {
  maxConnections          2000
  connTimeout             300
  maxKeepAliveReq         1000
  keepAliveTimeout        5
  maxReqBodySize          1024M
  enableGzipCompress      1
  gzipCompressLevel       6
}

# Procesador PHP 8.3
extprocessor lsphp83 {
  type                    lsphp
  address                 uds://tmp/lshttpd/lsphp.sock
  maxConns                50
  env                     PHP_LSAPI_CHILDREN=50
  initTimeout             60
  autoStart               2
  path                    /usr/local/lsws/lsphp83/bin/lsphp
}

# Asociar PHP con extensión .php
scripthandler  {
  add                     lsphp83 php
}

# Listener básico HTTP
listener Default {
  address                 *:80
  secure                  0
  map                     drupal10 *
}

# Virtual host Drupal
virtualhost drupal10 {
  vhRoot                  /var/www/html
  configFile              $SERVER_ROOT/conf/vhosts/drupal10/vhconf.conf
  allowSymbolLink         1
  enableScript            1
}